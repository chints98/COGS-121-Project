<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>NewsFeed Page</title>
        <link rel="stylesheet" href="styles.css">

        <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
                               integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <script type="text/javascript">

            $(document).ready(() => {

                var toggle_US = true;
                var params;
                var filters;
                var article_IDs = [];

                //Initial page loading 
                $.ajax({
                    url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&filter[operator]=AND&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][1][field]=body&profile=full&limit=3',
                    type: 'GET',
                    dataType: 'json',
                    success: (res) => {
                        console.log(res);
                        $('.article-header').each((index,element) => {
                            element.innerHTML = res.data[index].fields.title
                            article_IDs[index] = res.data[index].id
                        });
                    }
                });


                //Learn More click
                $('#learnBut1').click( () => {
                    if (toggle_US==false) {
                        filters = 'filter[operator]=OR&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][0][negate]=true&filter[conditions][1][field]=body&profile=full&limit=3' 
                    }
                    else {
                        filters = 'filter[operator]=AND&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][1][field]=body&profile=full&limit=3'
                    }
                    $.ajax({
                        url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&' + filters,
                        //url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&filter[operator]=AND&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][1][field]=body&profile=full&limit=3',
                        type: 'GET',
                        dataType: 'json',
                        success: (res) => {
                            console.log(res);
                            document.getElementById(("news"+1+"Text")).innerHTML = res.data[0].fields.body;
                            $('#news1Text').append('<button id="but_donate" type="button" class="btn btn-cust">Donate</button> <button id="but_volunteer" type="button" class="btn btn-cust">Volunteer</button>');
                            //Donate & Vol click
                            $('#but_donate').click(() => {
                                alert("You have clicked donate!")
                            });

                            $('#but_volunteer').click(() => {
                                alert("You have clicked volunteer!")
                            });



                        }
                    });
                });


                $('#learnBut2').click( () => { 
                    if (toggle_US==false) {
                        filters = 'filter[operator]=OR&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][0][negate]=true&filter[conditions][1][field]=body&profile=full&limit=3' 
                    }
                    else {
                        filters = 'filter[operator]=AND&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][1][field]=body&profile=full&limit=3'
                    }
                    $.ajax({
                        url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&' + filters,
                        type: 'GET',
                        dataType: 'json',
                        success: (res) => {
                            console.log(res);
                            document.getElementById(("news"+2+"Text")).innerHTML = res.data[1].fields.body;
                            $('#news2Text').append('<button id="but_donate2" type="button" class="btn btn-cust">Donate</button> <button id="but_volunteer2" type="button" class="btn btn-cust">Volunteer</button>');
                            //Donate & Vol click
                            $('#but_donate2').click(() => {
                                alert("You have clicked donate!")
                            });

                            $('#but_volunteer2').click(() => {
                                alert("You have clicked volunteer!")
                            });


                        }
                    });
                });


                $('#learnBut3').click( () => {
                    if (toggle_US==false) {
                        filters = 'filter[operator]=OR&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][0][negate]=true&filter[conditions][1][field]=body&profile=full&limit=3' 
                    }
                    else {
                        filters = 'filter[operator]=AND&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][1][field]=body&profile=full&limit=3'
                    }
                    $.ajax({
                        url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&' + filters,
                        type: 'GET',
                        dataType: 'json',
                        success: (res) => {
                            console.log(res);
                            document.getElementById(("news"+3+"Text")).innerHTML = res.data[2].fields.body;
                            $('#news3Text').append('<button id="but_donate3" type="button" class="btn btn-cust">Donate</button> <button id="but_volunteer3" type="button" class="btn btn-cust">Volunteer</button>');

                            //Donate & Vol click
                            $('#but_donate3').click(() => {
                                console.log('hi');
                                alert("You have clicked donate!")
                            });

                            $('#but_volunteer3').click(() => {
                                alert("You have clicked volunteer!")
                            });


                        }
                    });
                });


                //Toggle location filter
                $('#butNewsWorld').click( () => {
                    toggle_US = false;
                    $.ajax({        
                        url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&filter[operator]=OR&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][0][negate]=true&filter[conditions][1][field]=body&profile=full&limit=3',
                        type: 'GET',
                        dataType: 'json',
                        success: (res) => {
                            console.log(res);
                            $('.article-header').each((index,element) => {
                                console.log('world clicked!');
                                element.innerHTML = res.data[index].fields.title
                                document.getElementById(("news1Text")).innerHTML ="";
                                document.getElementById(("news2Text")).innerHTML ="";
                                document.getElementById(("news3Text")).innerHTML ="";

                            });
                        }



                    });

                });

                $('#butNewsUS').click( () => {
                    toggle_US = true;
                    $.ajax({    
                        url: 'https://api.reliefweb.int/v1/reports?appname=apidoc&query[value]=wildfire&filter[operator]=AND&filter[conditions][0][field]=country&filter[conditions][0][value]=USA&filter[conditions][1][field]=body&profile=full&limit=3',    
                        type: 'GET',
                        dataType: 'json',
                        success: (res) => {
                            console.log(res);
                            $('.article-header').each((index,element) => {
                                console.log('U.S. clicked!');
                                element.innerHTML = res.data[index].fields.title
                                document.getElementById(("news1Text")).innerHTML ="";
                                document.getElementById(("news2Text")).innerHTML ="";
                                document.getElementById(("news3Text")).innerHTML ="";

                            });
                        }



                    });

                });


                //Individual Page Linking

                $('#news1').click( () => {
                    window.location.href= '/news1Profile.html'

                });

            });
        </script>
    </head>

    <body>
        <div id="topNews">
            <img class="logoSize" src="./transparent_Logo.png" alt="logo">
        </div>


        <div class="back-button">
            <button id="logoutBut" type="button" class="btn btn-light">
                <a class="back" href="login.html">Logout</a>
            </button>  
        </div>



        <form id="topNews">
            <button id="butNewsUS" type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" autocomplete="off">
                US
            </button>
            <button id="butNewsWorld" type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" autocomplete="off">
                World
            </button>
        </form>



        <div class="article-card">
            <div class="newStyle" id="news1">
                <img class="newsStyle" src="./news1Pic.jpg" alt="news1">
            </div>
            <button id="learnBut1" type="button" class="btn btn-cust">Learn More</button>
            <h3 class="article-header"></h3>
            <p class="article-body" id="news1Text"></p>
        </div>

        <div class="article-card">
            <div class="newStyle" id="news2">
                <img class="newsStyle" src="./news1Pic.jpg" alt="news2">
            </div>
            <button id="learnBut2" type="button" class="btn btn-cust">Learn More</button>
            <h3 class="article-header"></h3>

            <p class="article-body" id="news2Text"></p>
        </div>



        <div class="article-card">
            <div class="newStyle" id="news3">
                <img class="newsStyle" src="./news1Pic.jpg" alt="news3">
            </div>
            <button id="learnBut3" type="button" class="btn btn-cust">Learn More</button>
            <h3 class="article-header"></h3>

            <p class="article-body" id="news3Text"></p>
        </div>

        <nav aria-label="Page navigation example" >
            <ul id="pageScroll" class="pagination">
                <li class="page-item"><a id="pageNum" class="page-link" href="#">Previous</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">1</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">2</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">3</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">Next</a></li>
            </ul>
        </nav>

    </body>

</html>
