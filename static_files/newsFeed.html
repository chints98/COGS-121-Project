<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>NewsFeed Page</title>
        <link rel="stylesheet" href="styles.css">

        <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
                               integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <script type="text/javascript">

            $(document).ready(() => {

                var toggle_US = true;
                var params;
                params = {
                    "query": "{\"$query\":{\"$and\":[{\"categoryUri\":\"dmoz/Science/Earth_Sciences/Natural_Disasters_and_Hazards\"},{\"$or\":[{\"sourceUri\":\"usatoday.com\"}]},{\"dateStart\":\"2019-04-22\",\"dateEnd\":\"2019-05-11\",\"lang\":\"eng\"}]}}",
                    "dataType": [
                        "news"
                    ],
                    "resultType": "articles",
                    "articlesSortBy": "socialScore",
                    "articlesCount": 20,
                    "articleBodyLen": -1,
                    "apiKey": "0e83afdd-e71d-47ed-bd2c-82cb0206df3a"
                }; 

                $.ajax({
                    url: 'http://eventregistry.org/api/v1/article/getArticles',
                    crossDomain: true,
                    data: params,
                    type: 'GET',
                    dataType: 'json',
                    success: (data) => {
                        console.log(data);
                        $('.article-header').each( (index,element) => {
                            element.append(data.articles.results[index].title);

                            //$('.article-header').append(data.headline)
                            //$('.article-body').append(data.body)

                            // console.log(data.headline)
                            // console.log(data.body)

                        });
                    }
                });

                

                //If there is no session, go back to home page
                // if (sessionStorage.getItem('authorized') != "yes") {
                //     window.location= 'login.html';
                // }

                //Individual profile click handler
                $(".newStyle").click(() => {
                    console.log('hi');
                    window.location.href = "news1Profile.html"

                });

                //Learn more click handler
                $('#learnBut1').click(() => { 

                    $.ajax({
                        url: 'http://eventregistry.org/api/v1/article/getArticles',
                        crossDomain: true,
                        data: params,
                        type: 'GET',
                        dataType: 'json',
                        success: (data) => {
                            console.log("news"  + "text")
                            document.getElementById(("news" + 1 + "Text")).innerHTML = data.articles.results[0].body;
                        }
                    });

                });

                $('#learnBut2').click(() => { 

                    $.ajax({
                        url: 'http://eventregistry.org/api/v1/article/getArticles',
                        crossDomain: true,
                        data: params,
                        type: 'GET',
                        dataType: 'json',
                        success: (data) => {
                            console.log("news"  + "text")
                            document.getElementById(("news" + 2 + "Text")).append(data.articles.results[1].body);
                        }
                    });

                });

                $('#learnBut3').click(() => { 

                    $.ajax({
                        url: 'http://eventregistry.org/api/v1/article/getArticles',
                        crossDomain: true,
                        data: params,
                        type: 'GET',
                        dataType: 'json',
                        success: (data) => {
                            console.log("news"  + "text")
                            document.getElementById(("news" + 3 + "Text")).append(data.articles.results[2].body);
                        }
                    });

                });

                $('#butNewsWorld').click( () => {

                    toggle_US = false;
                    params =  {
                        "query": "{\"$query\":{\"$and\":[{\"categoryUri\":\"dmoz/Science/Earth_Sciences/Natural_Disasters_and_Hazards\"},{\"$or\":[{\"sourceUri\":\"bbc.com\"}]},{\"dateStart\":\"2019-04-22\",\"dateEnd\":\"2019-05-11\",\"lang\":\"eng\"}]}}",
                        "dataType": [
                            "news"
                        ],
                        "resultType": "articles",
                        "articlesSortBy": "socialScore",
                        "articlesCount": 20,
                        "articleBodyLen": -1,
                        "apiKey": "0e83afdd-e71d-47ed-bd2c-82cb0206df3a"
                    };

                    $.ajax({
                        url: 'http://eventregistry.org/api/v1/article/getArticles',
                        crossDomain: true,
                        data: params,
                        type: 'GET',
                        dataType: 'json',
                        success: (data) => {
                            console.log(data);
                            $('.article-header').each( (index,element) => {
                                console.log(toggle_US);
                                console.log('hello');
                                element.innerHTML = (data.articles.results[index].title);
                                document.getElementById(("news" + 1 + "Text")).innerHTML = "";
                                document.getElementById(("news" + 2 + "Text")).innerHTML = "";
                                document.getElementById(("news" + 3 + "Text")).innerHTML = "";
                            });
                        }
                    });

                });


                //document.getElementById("learnBut1").click(learnMore(1));


            });
        </script>
    </head>

    <body>
        <div class="back-button">
            <button id="logoutBut" type="button" class="btn btn-light">
                <a class="back" href="login.html">Logout</a>
            </button>  
        </div>

        <div id="topNews">
            <img class="logoSize" src="./transparent_Logo.png" alt="logo">
        </div>


        <form id="topNews">
            <button id="butNewsUS" type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" autocomplete="off">
                US
            </button>
            <button id="butNewsWorld" type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" autocomplete="off">
                World
            </button>
        </form>



        <div class="article-card">
            <div class="newStyle" id="news1">
                <img class="newsStyle" src="./news1Pic.jpg" alt="news1">
            </div>
            <button id="learnBut1" type="button" class="btn btn-cust">Learn More</button>
            <h3 class="article-header"></h3>
            <p class="article-body" id="news1Text"></p>
        </div>

        <div class="article-card">
            <div class="newStyle" id="news2">
                <img class="newsStyle" src="./news1Pic.jpg" alt="news2">
            </div>
            <button id="learnBut2" type="button" class="btn btn-cust">Learn More</button>
            <h3 class="article-header"></h3>

            <p class="article-body" id="news2Text"></p>
        </div>



        <div class="article-card">
            <div class="newStyle" id="news3">
                <img class="newsStyle" src="./news1Pic.jpg" alt="news3">
            </div>
            <button id="learnBut3" type="button" class="btn btn-cust">Learn More</button>
            <h3 class="article-header"></h3>

            <p class="article-body" id="news3Text"></p>
        </div>

        <nav aria-label="Page navigation example" >
            <ul id="pageScroll" class="pagination">
                <li class="page-item"><a id="pageNum" class="page-link" href="#">Previous</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">1</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">2</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">3</a></li>
                <li class="page-item"><a id="pageNum" class="page-link" href="#">Next</a></li>
            </ul>
        </nav>

    </body>

</html>
